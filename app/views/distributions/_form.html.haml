-#= form_for(@distribution) do |f|
  -#- if @distribution.errors.any?
    #error_explanation
      %h2
        = pluralize(@distribution.errors.count, "error")
        prohibited this distribution from being saved:
      %ul
        - @distribution.errors.full_messages.each do |message|
          %li= message
  -#.actions
    -#= f.submit

.knockout-bind#distribution-new{ 'knockout_props' => distribution_new_props }
  .iterations
    %label Iterations
    %input{ 'data-bind' => "value: ajax_params.times_to_roll"}
  .dice-to-roll
    %label Number of Dice
    %input{ 'data-bind' => "value: ajax_params.tests()[0].number_of_dice"}
  %div ----------------------

  .rolls{ 'data-bind' => "foreach: ajax_params.tests()[0].rolls"}
    %div
      %b{ 'data-bind' => "text: roll_type" }
      %button{ 'data-bind' => "click: $parent.remove_roll" } Remove
      %button{ 'data-bind' => "click: $parent.add_before"} Add Before

    %div{ 'data-bind' => "if: roll_type == 'to hit shooting'"}
      %div{ 'data-bind' => "with: params"}
        %label Ballistic Skill
        %input{ 'type' => 'number', 'data-bind' => "attr: { id: 'ballistic_skill_' + $index() }, value: ballistic_skill" }
        %br
        %label Reroll
        %select{ 'data-bind' => "value: reroll" }
          %option{ 'value' => 'none' } None
          %option{ 'value' => 'all' } All
          %option{ 'value' => 'ones' } Ones

    %div{ 'data-bind' => "if: roll_type == 'to hit assaulting'"}
      %div{ 'data-bind' => "with: params"}
        %label Attacker's Weapon Skill
        %input{ 'type' => 'number', 'data-bind' => "attr: { id: 'attackers_ws_' + $index() }, value: attackers_ws" }
        %br
        %label Defender's Weapon Skill
        %input{ 'type' => 'number', 'data-bind' => "attr: { id: 'defenders_ws_' + $index() }, value: defenders_ws" }
        %br
        %label Reroll
        %select{ 'data-bind' => "value: reroll" }
          %option{ 'value' => 'none' } None
          %option{ 'value' => 'all' } All
          %option{ 'value' => 'ones' } Ones

    %div{ 'data-bind' => "if: roll_type == 'to wound'"}
      %div{ 'data-bind' => "with: params"}
        %label Strength
        %input{ 'type' => 'number', 'data-bind' => "attr: { id: 'strength_' + $index() }, value: strength" }
        %br
        %label Toughness
        %input{ 'type' => 'number', 'data-bind' => "attr: { id: 'toughness_' + $index() }, value: toughness" }
        %br
        %label Reroll
        %select{ 'data-bind' => "value: reroll" }
          %option{ 'value' => 'none' } None
          %option{ 'value' => 'all' } All
          %option{ 'value' => 'ones' } Ones

    %div{ 'data-bind' => "if: roll_type == 'armor penetration'"}
      %div{ 'data-bind' => "with: params"}
        %label Strength
        %input{ 'type' => 'number', 'data-bind' => "attr: { id: 'strength_' + $index() }, value: strength" }
        %label Armor Value
        %input{ 'type' => 'number', 'data-bind' => "attr: { id: 'armor_value_' + $index() }, value: armor_value" }

    %div{ 'data-bind' => "if: roll_type == 'save'"}
      %div{ 'data-bind' => "with: params"}
        %label Save
        %input{ 'type' => 'number', 'data-bind' => "attr: { id: 'save_' + $index() }, value: save" }

    %div ----------------------

  .new-roll-type
    %select{ 'data-bind' => "options: ROLL_TYPES, value: new_roll_type" }
    %button{ 'data-bind' => "click: add_roll"} Add Roll

  .actions
    %button{ 'data-bind' => "click: perform_calculation" }
      Perform Calculation

  .current-distribution
    %pre
      %code{ 'data-bind' => "html: distribution" }
